import{d as I,k as c,l as o,c as a,o as u,e as t,m as x,v as b,g as l,n as y,F as U,t as i,r as T}from"./index-CXsewVxE.js";import{d as V}from"./dayjs.min-BAJkae7J.js";const W={class:"flex gap-[8px]"},X={class:"flex flex-col gap-[16px]"},q={for:"costPerPiece",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},z={for:"initCount",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},G={for:"newCount",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},H=["min"],J={for:"months",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},K={for:"x",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},Q={for:"y",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},Z={class:"flex flex-col gap-[16px]"},ee={class:"p-[12px] border rounded bg-white/20"},te={key:0},ne={class:"font-semibold"},se={class:"p-[12px] border rounded bg-white/20"},le={key:0},oe={key:1,class:"flex flex-col gap-[8px]"},ae={class:"block"},ue={class:"text-sm font-semibold"},re={class:"p-[12px] border rounded bg-white/20"},ie={key:0},de={key:1},ve=I({__name:"index",setup(me){const g=c(500),w=c(4),D=c(4),M=c(2),Y=c("2025-08-01"),h=c(V().format("YYYY-MM-DD")),d=o(()=>{const n=Number(g.value);return Number.isFinite(n)&&n>0?n:0}),B=o(()=>{const n=Number(w.value);return Number.isFinite(n)&&n>0?Math.floor(n):0}),L=o(()=>{const n=Number(D.value);return Number.isFinite(n)&&n>0?Math.floor(n):0}),m=o(()=>{const n=Number(M.value);return Number.isFinite(n)&&n>0?Math.floor(n):0}),F=o(()=>Y.value?V(Y.value):null),p=o(()=>h.value?V(h.value):null),O=o(()=>!F.value||!p.value?null:p.value.startOf("day").diff(F.value.startOf("day"),"day"));function S(n,e){return Array.from({length:e},(s,r)=>{const f=n.add(r,"month"),v=f.add(1,"month"),C=v.diff(f,"day");return{key:`${f.format("YYYY-MM-DD")}-${v.format("YYYY-MM-DD")}`,start:f,end:v,days:C,dailyCost:C>0?d.value/C:0}})}const R=o(()=>!p.value||m.value<=0||d.value<=0?[]:S(p.value.startOf("day"),m.value)),A=o(()=>R.value.map(n=>({key:n.key,label:`${n.start.format("DD MMM YYYY")} → ${n.end.format("DD MMM YYYY")}`,days:n.days,dailyCost:n.dailyCost}))),j=o(()=>{if(!F.value||!p.value||m.value<=0||B.value<=0||d.value<=0)return 0;const n=F.value.startOf("day"),e=p.value.startOf("day");return S(n,m.value).reduce((s,r)=>{if(!r.end.isAfter(e))return s;const f=e.isAfter(r.start)?e:r.start,v=r.end.diff(f,"day");if(v<=0||r.days<=0)return s;const C=v*(d.value/r.days);return s+C},0)*B.value}),k=o(()=>L.value*d.value*m.value),P=o(()=>{const n=Math.min(j.value,k.value);return Number.isFinite(n)?n:0}),$=o(()=>k.value-P.value),_=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:2,maximumFractionDigits:2}),N=o(()=>({base:k.value,discount:P.value,final:$.value,baseFormatted:_.format(k.value),discountFormatted:_.format(P.value),finalFormatted:_.format($.value)})),E=o(()=>m.value>0&&d.value>0&&L.value>0);return(n,e)=>(u(),a(U,null,[e[17]||(e[17]=t("div",null,[t("h3",null,"Prompt:"),t("pre",null,`дано:
* x: дата последней покупки лицензий
* y: дата текущего дня (имитация now)
* costPerPiece: цена за одну лицензию
* initCount: текущие кол-во оплаченных лицензий
* newCount: заказонное кол-во лицензий которое хотим оплатить
* months: выбранное кол-во месяцев оплаты

нужно решить такие проблемы:
* понимать сколько стоит 1 лицензия в рамках 1-го дня (внимательно смотри так как разное кол-во дней в месяцах использую либу dayjs)
* рассчитать скидку за уже оплачиваемые лицензии (так как момент оплаты это y - дата)
* показать полную сумму и со скидкой

style:
* все расчеты должны быть в computed vue3`)],-1)),t("div",W,[t("section",X,[e[12]||(e[12]=t("h3",{class:"mb-[-8px]"}," Refs: ",-1)),t("label",q,[e[6]||(e[6]=t("span",null,"Cost per Piece:",-1)),x(t("input",{id:"costPerPiece","onUpdate:modelValue":e[0]||(e[0]=s=>y(g)?g.value=s:null),type:"number",min:"0",step:"1"},null,512),[[b,l(g),void 0,{number:!0}]])]),t("label",z,[e[7]||(e[7]=t("span",null,"Init Count:",-1)),x(t("input",{id:"initCount","onUpdate:modelValue":e[1]||(e[1]=s=>y(w)?w.value=s:null),type:"number",min:"0",step:"1"},null,512),[[b,l(w),void 0,{number:!0}]])]),t("label",G,[e[8]||(e[8]=t("span",null,"New Count:",-1)),x(t("input",{id:"newCount","onUpdate:modelValue":e[2]||(e[2]=s=>y(D)?D.value=s:null),type:"number",min:l(w),step:"1"},null,8,H),[[b,l(D),void 0,{number:!0}]])]),t("label",J,[e[9]||(e[9]=t("span",null,"Months:",-1)),x(t("input",{id:"months","onUpdate:modelValue":e[3]||(e[3]=s=>y(M)?M.value=s:null),type:"number",min:"0",step:"1"},null,512),[[b,l(M),void 0,{number:!0}]])]),t("label",K,[e[10]||(e[10]=t("span",null,"X:",-1)),x(t("input",{id:"x","onUpdate:modelValue":e[4]||(e[4]=s=>y(Y)?Y.value=s:null),type:"date"},null,512),[[b,l(Y)]])]),t("label",Q,[e[11]||(e[11]=t("span",null,"Y:",-1)),x(t("input",{id:"y","onUpdate:modelValue":e[5]||(e[5]=s=>y(h)?h.value=s:null),type:"date"},null,512),[[b,l(h)]])])]),t("section",Z,[e[16]||(e[16]=t("h3",{class:"mb-[-8px]"}," Computed: ",-1)),t("div",ee,[e[13]||(e[13]=t("h4",{class:"mb-[8px]"}," Итог ",-1)),l(E)?(u(),a(U,{key:1},[t("p",null,"Базовая стоимость: "+i(l(N).baseFormatted),1),t("p",null,"Скидка за уже оплаченные лицензии: −"+i(l(N).discountFormatted),1),t("p",ne," Итого к оплате: "+i(l(N).finalFormatted),1)],64)):(u(),a("p",te," Заполните стоимость, количество лицензий и месяцев для расчёта. "))]),t("div",se,[e[14]||(e[14]=t("h4",{class:"mb-[8px]"}," Стоимость 1 лицензии в день ",-1)),l(R).length?(u(),a("ul",oe,[(u(!0),a(U,null,T(l(A),s=>(u(),a("li",{key:s.key},[t("span",ae,i(s.label),1),t("span",ue,i(s.days)+" дн. · "+i(l(_).format(s.dailyCost))+" / день",1)]))),128))])):(u(),a("p",le," Укажите дату Y и количество месяцев, чтобы увидеть расчёт по дням. "))]),t("div",re,[e[15]||(e[15]=t("h4",{class:"mb-[8px]"}," Разница по дням между датами ",-1)),l(O)===null?(u(),a("p",ie," Заполните даты X и Y, чтобы рассчитать разницу. ")):(u(),a("p",de,i(l(O))+" дн. ",1))])])])],64))}});export{ve as default};
