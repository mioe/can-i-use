import{d as G,k as p,l as s,c as Y,o as P,e,m as f,v as x,j as c,t as a,F as H,r as J}from"./index-CXsewVxE.js";import{d as B}from"./dayjs.min-BAJkae7J.js";const K={class:"flex gap-[16px]"},Q={class:"flex flex-col gap-[16px]"},W={for:"costPerPiece",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},X={for:"initCount",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},Z={for:"newCount",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},$=["min"],_={for:"months",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},tt={for:"expAt",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},et={for:"nowAt",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},nt={class:"flex flex-1 flex-col gap-[16px]"},lt={class:"flex flex-col gap-[12px]"},st={class:"p-[16px] border rounded bg-white/70 flex flex-col gap-[8px]"},ot={class:"p-[16px] border rounded bg-white/70 flex flex-col gap-[10px]"},at={class:"text-sm"},rt={class:"flex flex-col gap-[10px]"},ut={class:"text-sm text-slate-600"},it={class:"p-[16px] border rounded bg-white/70 flex flex-col gap-[8px]"},xt=G({__name:"index",setup(dt){const o=p(500),i=p(4),y=p(5),V=p(2),k=B(),M=p(k.add(2,"months").format("YYYY-MM-DD")),C=p(k.format("YYYY-MM-DD")),A=s(()=>B(C.value).startOf("day")),S=s(()=>B(M.value).startOf("day")),I=s(()=>Math.max(0,Math.trunc(V.value))),b=s(()=>{const n=A.value,t=S.value;return!t.isValid()&&!n.isValid()?t:t.isValid()?n.isValid()&&t.isBefore(n)?n:t:n}),w=s(()=>{const n=b.value;return n.isValid()?n.add(I.value,"month"):n}),N=s(()=>{const n=b.value,t=w.value;return!n.isValid()||!t.isValid()||!t.isAfter(n)?0:t.diff(n,"day")}),E=s(()=>{const n=A.value;return!n.isValid()||o.value<=0?0:o.value/n.daysInMonth()}),U=s(()=>{const n=b.value,t=w.value;return!n.isValid()||!t.isValid()||!t.isAfter(n)||y.value<=0||o.value<=0?0:O(n,t,y.value)}),F=s(()=>{const n=A.value,t=S.value;return!n.isValid()||!t.isValid()||i.value<=0||o.value<=0?0:t.isAfter(n)?O(n,t,i.value):o.value*i.value}),R=s(()=>{const n=U.value-F.value;return n>0?n:0}),T=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:2,maximumFractionDigits:2}),j=s(()=>{const n=b.value,t=w.value;return!n.isValid()||!t.isValid()||!t.isAfter(n)||o.value<=0?[]:L(n,t)}),z=s(()=>w.value);function O(n,t,l){let r=0,u=n;for(;u.isBefore(t);){const g=u.daysInMonth(),d=u.endOf("month").add(1,"day").startOf("day"),v=d.isBefore(t)?d:t,D=v.diff(u,"day");if(D<=0)break;const q=o.value/g;r+=q*D*l,u=v}return Number(r.toFixed(2))}function L(n,t){const l=[];let r=n;for(;r.isBefore(t);){const u=r.daysInMonth(),g=r.endOf("month").add(1,"day").startOf("day"),d=g.isBefore(t)?g:t,v=d.diff(r,"day");if(v<=0)break;const D=o.value/u;l.push({start:r,end:d,days:v,perDay:D}),r=d}return l}const m=n=>T.format(n||0),h=n=>n?.isValid()?n.format("DD MMM YYYY"):"—";return(n,t)=>(P(),Y("div",K,[e("section",Q,[t[12]||(t[12]=e("h3",{class:"mb-[-8px]"}," Refs: ",-1)),e("label",W,[t[6]||(t[6]=e("span",null,"Cost per Piece:",-1)),f(e("input",{id:"costPerPiece","onUpdate:modelValue":t[0]||(t[0]=l=>o.value=l),type:"number",min:"0",step:"1"},null,512),[[x,o.value,void 0,{number:!0}]])]),e("label",X,[t[7]||(t[7]=e("span",null,"Init Count:",-1)),f(e("input",{id:"initCount","onUpdate:modelValue":t[1]||(t[1]=l=>i.value=l),type:"number",min:"0",step:"1"},null,512),[[x,i.value,void 0,{number:!0}]])]),e("label",Z,[t[8]||(t[8]=e("span",null,"New Count:",-1)),f(e("input",{id:"newCount","onUpdate:modelValue":t[2]||(t[2]=l=>y.value=l),type:"number",min:i.value,step:"1"},null,8,$),[[x,y.value,void 0,{number:!0}]])]),e("label",_,[t[9]||(t[9]=e("span",null,"Months:",-1)),f(e("input",{id:"months","onUpdate:modelValue":t[3]||(t[3]=l=>V.value=l),type:"number",min:"0",step:"1"},null,512),[[x,V.value,void 0,{number:!0}]])]),e("label",tt,[t[10]||(t[10]=e("span",null,"Exp At:",-1)),f(e("input",{id:"expAt","onUpdate:modelValue":t[4]||(t[4]=l=>M.value=l),type:"date"},null,512),[[x,M.value]])]),e("label",et,[t[11]||(t[11]=e("span",null,"Now At:",-1)),f(e("input",{id:"nowAt","onUpdate:modelValue":t[5]||(t[5]=l=>C.value=l),type:"date"},null,512),[[x,C.value]])])]),e("section",nt,[t[21]||(t[21]=e("h3",{class:"mb-[-8px]"}," Computed: ",-1)),e("div",lt,[e("article",st,[t[17]||(t[17]=e("h4",null,"Итог",-1)),e("p",null,[t[13]||(t[13]=c("Базовая стоимость: ",-1)),e("strong",null,a(m(U.value)),1)]),e("p",null,[t[14]||(t[14]=c("Скидка за уже оплаченные лицензии: ",-1)),e("strong",null,a(m(F.value)),1)]),e("p",null,[t[15]||(t[15]=c("Итого к оплате: ",-1)),e("strong",null,a(m(R.value)),1)]),e("p",null,[t[16]||(t[16]=c("Следующая оплата: ",-1)),e("strong",null,a(h(z.value)),1)])]),e("article",ot,[t[19]||(t[19]=e("h4",null,"Стоимость 1 лицензии в день",-1)),e("p",at,[t[18]||(t[18]=c(" Сегодня: ",-1)),e("strong",null,a(m(E.value)),1)]),e("ul",rt,[(P(!0),Y(H,null,J(j.value,l=>(P(),Y("li",{key:l.start.toISOString(),class:"flex flex-col"},[e("span",null,a(h(l.start))+" → "+a(h(l.end)),1),e("span",ut,a(l.days)+" дн. · "+a(m(l.perDay))+" / день",1)]))),128))])]),e("article",it,[t[20]||(t[20]=e("h4",null,"Разница по дням между датами",-1)),e("p",null,a(N.value)+" дн.",1)])])])]))}});export{xt as default};
