import{d as G,m as d,n as a,c as Y,a as n,t as r,u as H,p,v as f,l as v,F as I,r as J,o as B}from"./index-Vn0mbn0d.js";import{d as F}from"./dayjs.min-BAJkae7J.js";const K=`> cursor 1.6.23 (Universal) | gpt-5-codex MAX | 09/25/2025

## дано:

- expAt: дата окончания всех лицензий
- nowAt: дата текущего дня (имитация now)
- costPerPiece: цена за одну лицензию
- initCount: текущие кол-во оплаченных лицензий
- newCount: заказонное кол-во лицензий которое хотим оплатить
- months: выбранное кол-во месяцев оплаты

## нужно решить такие проблемы:

- понимать сколько стоит 1 лицензия в рамках 1-го дня (внимательно смотри так как разное кол-во дней в месяцах использую либу dayjs)
- рассчитать скидку за уже оплачиваемые лицензии (так как момент оплаты это y - дата)
- показать полную сумму и со скидкой
- кол-во месяцев добавляются к expAt, НО если expAt < nowAt - то только тогда мы месяца добавляем к nowAt
- находи среднюю стоимость дня на основе разности месяцев и ее учитывай при расчете скидки

## style:

- все расчеты должны быть в computed vue3
`,Q={class:"text-[12px] text-wrap"},W={class:"flex flex-wrap gap-[16px]"},Z={class:"flex flex-col gap-[16px] min-w-[200px]"},$={for:"costPerPiece",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},_={for:"initCount",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},tt={for:"newCount",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},nt=["min"],et={for:"months",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},ot={for:"expAt",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},st={for:"nowAt",class:"p-[4px] border rounded bg-white/30 flex flex-col max-w-[200px]"},lt={class:"flex flex-1 flex-col gap-[16px] min-w-[200px]"},at={class:"flex flex-col gap-[12px]"},rt={class:"p-[16px] border rounded bg-white/30 flex flex-col gap-[8px]"},ut={class:"p-[16px] border rounded bg-white/30 flex flex-col gap-[10px]"},it={class:"text-sm"},dt={class:"flex flex-col gap-[10px]"},pt={class:"text-sm"},ft={class:"p-[16px] border rounded bg-white/30 flex flex-col gap-[8px]"},vt=G({__name:"index",setup(xt){const u=d(500),x=d(4),y=d(5),V=d(2),U=F(),M=d(U.add(2,"months").format("YYYY-MM-DD")),A=d(U.format("YYYY-MM-DD")),C=a(()=>F(A.value).startOf("day")),h=a(()=>F(M.value).startOf("day")),O=a(()=>Math.max(0,Math.trunc(V.value))),b=a(()=>{const e=C.value,t=h.value;return!t.isValid()&&!e.isValid()?t:t.isValid()?e.isValid()&&t.isBefore(e)?e:t:e}),w=a(()=>{const e=b.value;return e.isValid()?e.add(O.value,"month"):e}),R=a(()=>{const e=b.value,t=w.value;return!e.isValid()||!t.isValid()||!t.isAfter(e)?0:t.diff(e,"day")}),N=a(()=>{const e=b.value,t=w.value;return!e.isValid()||!t.isValid()||!t.isAfter(e)||y.value<=0||u.value<=0?0:L(e,t,y.value)}),S=a(()=>{const e=C.value,t=h.value;if(!e.isValid()||!t.isValid()||u.value<=0)return 0;const o=t.diff(e,"month",!0);if(o<=0)return u.value/e.daysInMonth();const l=Math.max(t.diff(e,"day"),1)/o;return!Number.isFinite(l)||l<=0?0:u.value/l}),k=a(()=>{const e=C.value,t=h.value;if(!e.isValid()||!t.isValid()||x.value<=0||u.value<=0)return 0;const o=Math.max(t.diff(e,"day"),0);if(o<=0)return 0;const s=S.value;return s<=0?0:Number((s*o*x.value).toFixed(2))}),E=a(()=>{const e=N.value-k.value;return e>0?e:0}),T=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:2,maximumFractionDigits:2}),j=a(()=>{const e=b.value,t=w.value;return!e.isValid()||!t.isValid()||!t.isAfter(e)||u.value<=0?[]:X(e,t)}),z=a(()=>w.value);function L(e,t,o){let s=0,l=e;for(;l.isBefore(t);){const g=l.daysInMonth(),i=l.endOf("month").add(1,"day").startOf("day"),c=i.isBefore(t)?i:t,D=c.diff(l,"day");if(D<=0)break;const q=u.value/g;s+=q*D*o,l=c}return Number(s.toFixed(2))}function X(e,t){const o=[];let s=e;for(;s.isBefore(t);){const l=s.daysInMonth(),g=s.endOf("month").add(1,"day").startOf("day"),i=g.isBefore(t)?g:t,c=i.diff(s,"day");if(c<=0)break;const D=u.value/l;o.push({start:s,end:i,days:c,perDay:D,monthDays:l}),s=i}return o}const m=e=>T.format(e||0),P=e=>e?.isValid()?e.format("DD MMM YYYY"):"—";return(e,t)=>(B(),Y(I,null,[n("section",null,[t[6]||(t[6]=n("h3",null,"Prompt",-1)),n("pre",Q,r(H(K)),1)]),n("div",W,[n("section",Z,[t[13]||(t[13]=n("h3",{class:"mb-[-8px]"}," Refs: ",-1)),n("label",$,[t[7]||(t[7]=n("span",null,"Cost per Piece:",-1)),p(n("input",{id:"costPerPiece","onUpdate:modelValue":t[0]||(t[0]=o=>u.value=o),type:"number",min:"0",step:"1"},null,512),[[f,u.value,void 0,{number:!0}]])]),n("label",_,[t[8]||(t[8]=n("span",null,"Init Count:",-1)),p(n("input",{id:"initCount","onUpdate:modelValue":t[1]||(t[1]=o=>x.value=o),type:"number",min:"0",step:"1"},null,512),[[f,x.value,void 0,{number:!0}]])]),n("label",tt,[t[9]||(t[9]=n("span",null,"New Count:",-1)),p(n("input",{id:"newCount","onUpdate:modelValue":t[2]||(t[2]=o=>y.value=o),type:"number",min:x.value,step:"1"},null,8,nt),[[f,y.value,void 0,{number:!0}]])]),n("label",et,[t[10]||(t[10]=n("span",null,"Months:",-1)),p(n("input",{id:"months","onUpdate:modelValue":t[3]||(t[3]=o=>V.value=o),type:"number",min:"0",step:"1"},null,512),[[f,V.value,void 0,{number:!0}]])]),n("label",ot,[t[11]||(t[11]=n("span",null,"Exp At:",-1)),p(n("input",{id:"expAt","onUpdate:modelValue":t[4]||(t[4]=o=>M.value=o),type:"date"},null,512),[[f,M.value]])]),n("label",st,[t[12]||(t[12]=n("span",null,"Now At:",-1)),p(n("input",{id:"nowAt","onUpdate:modelValue":t[5]||(t[5]=o=>A.value=o),type:"date"},null,512),[[f,A.value]])])]),n("section",lt,[t[22]||(t[22]=n("h3",{class:"mb-[-8px]"}," Computed: ",-1)),n("div",at,[n("article",rt,[t[18]||(t[18]=n("h4",null,"Итог",-1)),n("p",null,[t[14]||(t[14]=v("Базовая стоимость: ",-1)),n("strong",null,r(m(N.value)),1)]),n("p",null,[t[15]||(t[15]=v("Скидка за уже оплаченные лицензии: ",-1)),n("strong",null,r(m(k.value)),1)]),n("p",null,[t[16]||(t[16]=v("Итого к оплате: ",-1)),n("strong",null,r(m(E.value)),1)]),n("p",null,[t[17]||(t[17]=v("Следующая оплата: ",-1)),n("strong",null,r(P(z.value)),1)])]),n("article",ut,[t[20]||(t[20]=n("h4",null,"Стоимость 1 лицензии в день",-1)),n("p",it,[t[19]||(t[19]=v(" Средняя: ",-1)),n("strong",null,r(m(S.value)),1)]),n("ul",dt,[(B(!0),Y(I,null,J(j.value,o=>(B(),Y("li",{key:o.start.toISOString(),class:"flex flex-col"},[n("span",null,r(P(o.start))+" → "+r(P(o.end)),1),n("span",pt,r(o.days)+" дн. из "+r(o.monthDays)+" · "+r(m(o.perDay))+" / день",1)]))),128))])]),n("article",ft,[t[21]||(t[21]=n("h4",null,"Разница по дням между датами",-1)),n("p",null,r(R.value)+" дн.",1)])])])])],64))}});export{vt as default};
